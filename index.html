<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜ì—… ì¼ì • ê³„ì‚°ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
        }

        .content {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 30px;
            padding: 30px;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .input-group input:focus, .input-group textarea:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .input-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }
        
        #customHolidaysList {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: white;
        }

        .custom-holiday-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px dashed #e9ecef;
            font-size: 14px;
        }

        .custom-holiday-item:last-child {
            border-bottom: none;
        }

        .custom-holiday-item button {
            background: none;
            border: none;
            color: #dc3545;
            cursor: pointer;
            font-size: 16px;
            padding: 0 5px;
            line-height: 1;
        }

        .result-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .result-section h3 {
            margin-bottom: 15px;
            color: #667eea;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .result-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .result-item label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .result-item .value {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        /* ì°¨ìˆ˜ë³„ ì •ë³´ í‘œì‹œ ìŠ¤íƒ€ì¼ */
        .period-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .period-section h3 {
            margin-bottom: 15px;
            color: #667eea;
        }

        .period-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #764ba2;
        }

        .period-item h4 {
            color: #764ba2;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .period-item .period-info {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .period-info-item {
            font-size: 13px;
        }

        .period-info-item strong {
            display: block;
            color: #666;
            font-size: 11px;
            margin-bottom: 3px;
        }

        .period-info-item span {
            color: #333;
            font-weight: 600;
        }

        .calendar-section {
            padding: 10px;
        }

        .calendar-month {
            margin-bottom: 30px;
        }

        .calendar-month h4 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            background: white;
            padding: 10px;
            border-radius: 10px;
        }

        .calendar-header {
            text-align: center;
            font-weight: 600;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .calendar-header.sat {
            color: #0066cc;
        }

        .calendar-header.sun {
            color: #dc3545;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 5px;
            font-size: 14px;
            position: relative;
        }

        .calendar-day.empty {
            border: none;
        }

        .calendar-day.weekend {
            background: #f0f0f0;
        }

        .calendar-day.sat {
            color: #0066cc;
        }

        .calendar-day.sun, .calendar-day.holiday {
            color: #dc3545;
        }

        .calendar-day.class-day {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        .calendar-day.start-day {
            background: #28a745;
            color: white;
            font-weight: 600;
        }

        .calendar-day.end-day {
            background: #dc3545;
            color: white;
            font-weight: 600;
        }

        .calendar-day.custom-holiday {
            background: #ffc107;
        }

        .holiday-name {
            font-size: 9px;
            text-align: center;
            margin-top: 2px;
            line-height: 1.2;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 100%;
        }

        .saved-courses {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .saved-courses h3 {
            margin-bottom: 15px;
            color: #667eea;
        }

        .course-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid #667eea;
        }

        .course-item:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .course-item h4 {
            margin-bottom: 5px;
            color: #333;
        }

        .course-item p {
            font-size: 12px;
            color: #666;
            margin: 3px 0;
        }

        .course-item button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 10px;
        }

        .legend {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        @media (max-width: 1200px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“š ìˆ˜ì—… ì¼ì • ê³„ì‚°ê¸°</h1>
            <p>ì£¼ë§ê³¼ ê³µíœ´ì¼ì„ ì œì™¸í•œ ì •í™•í•œ ìˆ˜ì—… ì¢…ë£Œì¼ì„ ê³„ì‚°í•©ë‹ˆë‹¤</p>
        </div>

        <div class="content">
            <div>
                <div class="input-section">
                    <h3 style="margin-bottom: 20px;">ì¼ì • ì„¤ì •</h3>
                    
                    <div class="input-group">
                        <label>ê³¼ì •ëª…</label>
                        <input type="text" id="courseName" placeholder="ì˜ˆ: ì›¹ê°œë°œ ê¸°ì´ˆê³¼ì •">
                    </div>

                    <div class="input-group">
                        <label>ì‹œì‘ ë‚ ì§œ</label>
                        <input type="date" id="startDate">
                    </div>

                    <div class="input-group">
                        <label>1ì¼ ìˆ˜ì—…ì‹œê°„ (ì‹œê°„)</label>
                        <input type="number" id="dailyHours" min="1" max="24" value="8">
                    </div>

                    <div class="input-group">
                        <label>ì´ ìˆ˜ì—…ì‹œê°„ (ì‹œê°„)</label>
                        <input type="number" id="totalHours" min="1" value="100">
                    </div>

                    <div class="input-group">
                        <label>ì¶”ê°€ íœ´ê°• (ì£¼ë§/ê³µíœ´ì¼ ì™¸)</label>
                        <input type="date" id="newCustomHolidayDate" style="margin-bottom: 5px;">
                        <input type="text" id="newCustomHolidayName" placeholder="ì¼ì •ëª… (ì˜ˆ: ì›Œí¬ìˆ)">
                        <button class="btn btn-secondary" onclick="addCustomHoliday()" style="margin-top: 10px; padding: 10px; width: auto;">ì¶”ê°€</button>
                    </div>

                    <div id="customHolidaysList"></div>

                    <button class="btn btn-primary" onclick="calculate()">ê³„ì‚°í•˜ê¸°</button>
                    <button class="btn btn-success" onclick="saveCourse()">ê³¼ì • ì €ì¥í•˜ê¸°</button>
                    <button class="btn btn-secondary" onclick="clearForm()">ì´ˆê¸°í™”</button>
                </div>

                <div class="saved-courses" id="savedCourses" style="display: none;">
                    <h3>ì €ì¥ëœ ê³¼ì •</h3>
                    <div id="coursesList"></div>
                </div>
            </div>

            <div>
                <div class="result-section" id="resultSection" style="display: none;">
                    <h3 id="resultTitle">ğŸ“Š ê³„ì‚° ê²°ê³¼</h3>
                    <div class="result-grid">
                        <div class="result-item">
                            <label>ì‹œì‘ì¼</label>
                            <div class="value" id="resultStartDate">-</div>
                        </div>
                        <div class="result-item">
                            <label>ì¢…ë£Œì¼</label>
                            <div class="value" id="resultEndDate">-</div>
                        </div>
                        <div class="result-item">
                            <label>ì „ì²´ ê¸°ê°„</label>
                            <div class="value" id="resultTotalDays">-</div>
                        </div>
                        <div class="result-item">
                            <label>ì‹¤ì œ ìˆ˜ì—…ì¼</label>
                            <div class="value" id="resultClassDays">-</div>
                        </div>
                        <div class="result-item">
                            <label>ì œì™¸ëœ ì£¼ë§</label>
                            <div class="value" id="resultWeekends">-</div>
                        </div>
                        <div class="result-item">
                            <label>ì œì™¸ëœ ê³µíœ´ì¼</label>
                            <div class="value" id="resultHolidays">-</div>
                        </div>
                    </div>
                </div>

                <div class="period-section" id="periodSection" style="display: none;">
                    <h3 id="periodTitle">ğŸ“… ì°¨ìˆ˜ë³„ êµìœ¡ ê¸°ê°„</h3>
                    <div id="periodList"></div>
                </div>

                <div class="legend" id="legend" style="display: none;">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #28a745;"></div>
                        <span>ì‹œì‘ì¼</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #dc3545;"></div>
                        <span>ì¢…ë£Œì¼</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                        <span>ìˆ˜ì—…ì¼</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ffc107;"></div>
                        <span>ì¶”ê°€ íœ´ê°•</span>
                    </div>
                </div>

                <div class="calendar-section" id="calendarSection"></div>
            </div>
        </div>
    </div>

    <script>
        const officialHolidays = {
            '2025-01-01': 'ì‹ ì •',
            '2025-01-28': 'ì„¤ë‚  ì—°íœ´',
            '2025-01-29': 'ì„¤ë‚ ',
            '2025-01-30': 'ì„¤ë‚  ì—°íœ´',
            '2025-03-01': '3Â·1ì ˆ',
            '2025-05-05': 'ì–´ë¦°ì´ë‚ ',
            '2025-05-06': 'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚  (ëŒ€ì²´ê³µíœ´ì¼)',
            '2025-06-06': 'í˜„ì¶©ì¼',
            '2025-08-15': 'ê´‘ë³µì ˆ',
            '2025-10-03': 'ê°œì²œì ˆ',
            '2025-10-06': 'ì¶”ì„ ì—°íœ´',
            '2025-10-07': 'ì¶”ì„',
            '2025-10-08': 'ì¶”ì„ ì—°íœ´',
            '2025-10-09': 'í•œê¸€ë‚ ',
            '2025-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤',
            '2026-01-01': 'ì‹ ì •',
            '2026-02-16': 'ì„¤ë‚  ì—°íœ´',
            '2026-02-17': 'ì„¤ë‚ ',
            '2026-02-18': 'ì„¤ë‚  ì—°íœ´',
            '2026-03-01': '3Â·1ì ˆ',
            '2026-03-02': '3Â·1ì ˆ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2026-05-05': 'ì–´ë¦°ì´ë‚ ',
            '2026-05-25': 'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ',
            '2026-06-06': 'í˜„ì¶©ì¼',
            '2026-08-15': 'ê´‘ë³µì ˆ',
            '2026-08-17': 'ê´‘ë³µì ˆ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2026-09-24': 'ì¶”ì„ ì—°íœ´',
            '2026-09-25': 'ì¶”ì„',
            '2026-09-26': 'ì¶”ì„ ì—°íœ´',
            '2026-09-28': 'ì¶”ì„ ì—°íœ´ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2026-10-03': 'ê°œì²œì ˆ',
            '2026-10-05': 'ê°œì²œì ˆ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2026-10-09': 'í•œê¸€ë‚ ',
            '2026-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤',
            '2027-01-01': 'ì‹ ì •',
            '2027-02-05': 'ì„¤ë‚  ì—°íœ´',
            '2027-02-06': 'ì„¤ë‚ ',
            '2027-02-07': 'ì„¤ë‚  ì—°íœ´',
            '2027-02-08': 'ì„¤ë‚  (ëŒ€ì²´ê³µíœ´ì¼)',
            '2027-02-09': 'ì„¤ë‚  ì—°íœ´ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2027-03-01': '3Â·1ì ˆ',
            '2027-05-05': 'ì–´ë¦°ì´ë‚ ',
            '2027-05-14': 'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ',
            '2027-06-06': 'í˜„ì¶©ì¼',
            '2027-08-15': 'ê´‘ë³µì ˆ',
            '2027-08-16': 'ê´‘ë³µì ˆ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2027-09-14': 'ì¶”ì„ ì—°íœ´',
            '2027-09-15': 'ì¶”ì„',
            '2027-09-16': 'ì¶”ì„ ì—°íœ´',
            '2027-10-03': 'ê°œì²œì ˆ',
            '2027-10-04': 'ê°œì²œì ˆ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2027-10-09': 'í•œê¸€ë‚ ',
            '2027-10-11': 'í•œê¸€ë‚  (ëŒ€ì²´ê³µíœ´ì¼)',
            '2027-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤',
            '2028-01-01': 'ì‹ ì •',
            '2028-01-25': 'ì„¤ë‚  ì—°íœ´',
            '2028-01-26': 'ì„¤ë‚ ',
            '2028-01-27': 'ì„¤ë‚  ì—°íœ´',
            '2028-03-01': '3Â·1ì ˆ',
            '2028-05-05': 'ì–´ë¦°ì´ë‚ ',
            '2028-05-02': 'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ',
            '2028-06-06': 'í˜„ì¶©ì¼',
            '2028-08-15': 'ê´‘ë³µì ˆ',
            '2028-09-30': 'ì¶”ì„ ì—°íœ´',
            '2028-10-01': 'ì¶”ì„',
            '2028-10-02': 'ì¶”ì„ ì—°íœ´',
            '2028-10-03': 'ê°œì²œì ˆ',
            '2028-10-04': 'ì¶”ì„ ì—°íœ´ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2028-10-05': 'ì¶”ì„ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2028-10-09': 'í•œê¸€ë‚ ',
            '2028-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤',
            '2029-01-01': 'ì‹ ì •',
            '2029-02-12': 'ì„¤ë‚  ì—°íœ´',
            '2029-02-13': 'ì„¤ë‚ ',
            '2029-02-14': 'ì„¤ë‚  ì—°íœ´',
            '2029-03-01': '3Â·1ì ˆ',
            '2029-05-05': 'ì–´ë¦°ì´ë‚ ',
            '2029-05-07': 'ì–´ë¦°ì´ë‚  (ëŒ€ì²´ê³µíœ´ì¼)',
            '2029-05-21': 'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ',
            '2029-06-06': 'í˜„ì¶©ì¼',
            '2029-08-15': 'ê´‘ë³µì ˆ',
            '2029-09-19': 'ì¶”ì„ ì—°íœ´',
            '2029-09-20': 'ì¶”ì„',
            '2029-09-21': 'ì¶”ì„ ì—°íœ´',
            '2029-10-03': 'ê°œì²œì ˆ',
            '2029-10-09': 'í•œê¸€ë‚ ',
            '2029-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤',
            '2030-01-01': 'ì‹ ì •',
            '2030-02-02': 'ì„¤ë‚  ì—°íœ´',
            '2030-02-03': 'ì„¤ë‚ ',
            '2030-02-04': 'ì„¤ë‚  ì—°íœ´',
            '2030-02-05': 'ì„¤ë‚  ì—°íœ´ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2030-02-06': 'ì„¤ë‚  (ëŒ€ì²´ê³µíœ´ì¼)',
            '2030-03-01': '3Â·1ì ˆ',
            '2030-05-05': 'ì–´ë¦°ì´ë‚ ',
            '2030-05-06': 'ì–´ë¦°ì´ë‚  (ëŒ€ì²´ê³µíœ´ì¼)',
            '2030-05-10': 'ë¶€ì²˜ë‹˜ì˜¤ì‹ ë‚ ',
            '2030-06-06': 'í˜„ì¶©ì¼',
            '2030-08-15': 'ê´‘ë³µì ˆ',
            '2030-09-08': 'ì¶”ì„ ì—°íœ´',
            '2030-09-09': 'ì¶”ì„',
            '2030-09-10': 'ì¶”ì„ ì—°íœ´',
            '2030-09-11': 'ì¶”ì„ ì—°íœ´ (ëŒ€ì²´ê³µíœ´ì¼)',
            '2030-10-03': 'ê°œì²œì ˆ',
            '2030-10-09': 'í•œê¸€ë‚ ',
            '2030-12-25': 'í¬ë¦¬ìŠ¤ë§ˆìŠ¤'
        };

        let customHolidays = loadCustomHolidays();
        let savedCourses = loadSavedCourses();

        function loadCustomHolidays() {
            const saved = localStorage.getItem('customHolidays');
            return saved ? JSON.parse(saved) : [];
        }

        function saveCustomHolidays() {
            localStorage.setItem('customHolidays', JSON.stringify(customHolidays));
            displayCustomHolidays();
        }

        function loadSavedCourses() {
            const saved = localStorage.getItem('savedCourses');
            return saved ? JSON.parse(saved) : [];
        }

        function saveCourseToStorage() {
            localStorage.setItem('savedCourses', JSON.stringify(savedCourses));
        }

        function displayCustomHolidays() {
            const list = document.getElementById('customHolidaysList');
            list.innerHTML = '';
            
            customHolidays.sort((a, b) => a.date.localeCompare(b.date));

            customHolidays.forEach((holiday, index) => {
                const item = document.createElement('div');
                item.className = 'custom-holiday-item';
                item.innerHTML = `
                    <span>${holiday.date} (${holiday.name})</span>
                    <button onclick="removeCustomHoliday(${index})">Ã—</button>
                `;
                list.appendChild(item);
            });
        }

        function addCustomHoliday() {
            const dateInput = document.getElementById('newCustomHolidayDate').value;
            const nameInput = document.getElementById('newCustomHolidayName').value.trim() || 'ì¶”ê°€ íœ´ê°•';

            if (!dateInput) {
                alert('íœ´ê°• ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const dateStr = dateInput;

            if (customHolidays.some(h => h.date === dateStr)) {
                alert('ì´ë¯¸ ë“±ë¡ëœ íœ´ê°• ë‚ ì§œì…ë‹ˆë‹¤.');
                return;
            }
            
            if (officialHolidays[dateStr]) {
                 if (!confirm(`ì„ íƒí•œ ë‚ ì§œ(${dateStr})ëŠ” ì´ë¯¸ ê³µíœ´ì¼(${officialHolidays[dateStr]})ì…ë‹ˆë‹¤. ê·¸ë˜ë„ ì¶”ê°€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    return;
                }
            }

            customHolidays.push({ date: dateStr, name: nameInput });
            saveCustomHolidays();
            document.getElementById('newCustomHolidayDate').value = '';
            document.getElementById('newCustomHolidayName').value = '';
        }

        function removeCustomHoliday(index) {
            customHolidays.splice(index, 1);
            saveCustomHolidays();
        }

        function displaySavedCourses() {
            const container = document.getElementById('savedCourses');
            const list = document.getElementById('coursesList');
            
            if (savedCourses.length === 0) {
                container.style.display = 'none';
                return;
            }

            container.style.display = 'block';
            list.innerHTML = '';

            savedCourses.forEach((course, index) => {
                const item = document.createElement('div');
                item.className = 'course-item';
                item.innerHTML = `
                    <h4>${course.name}</h4>
                    <p>ğŸ“… ${course.startDate} ~ ${course.endDate}</p>
                    <p>â° 1ì¼ ${course.dailyHours}ì‹œê°„ Ã— ${course.classDays}ì¼ = ì´ ${course.totalHours}ì‹œê°„</p>
                    <button onclick="deleteCourse(event, ${index})">ì‚­ì œ</button>
                    <button onclick="loadCourse(event, ${index})" style="background: #667eea; margin-left: 5px;">ë¶ˆëŸ¬ì˜¤ê¸°</button>
                `;
                list.appendChild(item);
            });
        }

        function deleteCourse(event, index) {
            event.stopPropagation();
            if (confirm('ì´ ê³¼ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                savedCourses.splice(index, 1);
                saveCourseToStorage();
                displaySavedCourses();
            }
        }

        function loadCourse(event, index) {
            event.stopPropagation();
            const course = savedCourses[index];
            document.getElementById('courseName').value = course.name;
            document.getElementById('startDate').value = course.startDate;
            document.getElementById('dailyHours').value = course.dailyHours;
            document.getElementById('totalHours').value = course.totalHours;

            customHolidays = course.customHolidays || [];
            saveCustomHolidays();
            
            calculate();
        }

        function isWeekend(date) {
            const day = date.getDay();
            return day === 0 || day === 6;
        }

        function isHoliday(dateStr) {
            return officialHolidays[dateStr] || customHolidays.some(h => h.date === dateStr);
        }

        function getHolidayName(dateStr) {
            if (officialHolidays[dateStr]) return officialHolidays[dateStr];
            const customHoliday = customHolidays.find(h => h.date === dateStr);
            if (customHoliday) return customHoliday.name;
            return null;
        }

        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        // ë§Œ 1ê°œì›” í›„ ë‚ ì§œ ê³„ì‚° í•¨ìˆ˜
        function addOneMonth(date) {
            const newDate = new Date(date);
            newDate.setMonth(newDate.getMonth() + 1);
            newDate.setDate(newDate.getDate() - 1);
            return newDate;
        }

        function calculate() {
            const startDateInput = document.getElementById('startDate').value;
            const dailyHours = parseInt(document.getElementById('dailyHours').value);
            const totalHours = parseInt(document.getElementById('totalHours').value);
            const courseName = document.getElementById('courseName').value.trim();

            if (!startDateInput || !dailyHours || !totalHours) {
                alert('ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const requiredDays = Math.ceil(totalHours / dailyHours);
            let currentDate = new Date(startDateInput);

            let classDaysCount = 0;
            let weekendCount = 0;
            let holidayCount = 0;
            const classDates = [];
            
            const maxDaysCheck = 365 * 10;
            let iterationCount = 0;

            while (classDaysCount < requiredDays) {
                if (iterationCount > maxDaysCheck) {
                    alert('ê³„ì‚°ì— ë„ˆë¬´ ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦½ë‹ˆë‹¤. ì…ë ¥ê°’ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const dateStr = formatDate(currentDate);
                const isWE = isWeekend(currentDate);
                const isH = isHoliday(dateStr);
                
                if (classDates.length === 0 && dateStr === startDateInput) {
                    if (!isWE && !isH) {
                         classDates.push(new Date(currentDate));
                         classDaysCount++;
                    } else {
                        if (isWE) weekendCount++;
                        if (isH) holidayCount++;
                    }
                } else if (classDates.length > 0 || dateStr !== startDateInput) {
                    if (!isWE && !isH) {
                        classDates.push(new Date(currentDate));
                        classDaysCount++;
                    } else {
                        if (isWE) weekendCount++;
                        if (isH) holidayCount++;
                    }
                }
                
                currentDate.setDate(currentDate.getDate() + 1);
                iterationCount++;
            }

            const startDate = new Date(startDateInput);
            const endDate = classDates[classDates.length - 1];
            const totalDays = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;

            // ê¸°ë³¸ ê²°ê³¼ í‘œì‹œ
            document.getElementById('resultStartDate').textContent = formatDate(startDate);
            document.getElementById('resultEndDate').textContent = formatDate(endDate);
            document.getElementById('resultTotalDays').textContent = `${totalDays}ì¼`;
            document.getElementById('resultClassDays').textContent = `${classDaysCount}ì¼`;
            document.getElementById('resultWeekends').textContent = `${weekendCount}ì¼`;
            document.getElementById('resultHolidays').textContent = `${holidayCount}ì¼`;

            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('legend').style.display = 'flex';

            // ê³„ì‚° ê²°ê³¼ ì œëª© ì„¤ì •
            const resultTitle = courseName ? `ğŸ“Š ${courseName} - ê³„ì‚° ê²°ê³¼` : 'ğŸ“Š ê³„ì‚° ê²°ê³¼';
            document.getElementById('resultTitle').textContent = resultTitle;

            // ì°¨ìˆ˜ë³„ ê¸°ê°„ ì œëª© ì„¤ì •
            const periodTitle = courseName ? `ğŸ“… ${courseName} - ì°¨ìˆ˜ë³„ êµìœ¡ ê¸°ê°„` : 'ğŸ“… ì°¨ìˆ˜ë³„ êµìœ¡ ê¸°ê°„';
            document.getElementById('periodTitle').textContent = periodTitle;

            // ì°¨ìˆ˜ë³„ ê¸°ê°„ ê³„ì‚°
            calculatePeriods(startDate, classDates, dailyHours);

            // ë‹¬ë ¥ ìƒì„±
            generateCalendar(startDate, endDate, classDates);
        }

        // ì°¨ìˆ˜ë³„ ê¸°ê°„ ê³„ì‚° í•¨ìˆ˜ (ìˆ˜ì •: ì´ ìˆ˜ì—…ì‹œê°„ ì œí•œ, ìˆ˜ì—…ì¼ ê³„ì‚° ë°©ì‹ ë³€ê²½)
        function calculatePeriods(startDate, classDates, dailyHours) {
            const totalHours = parseInt(document.getElementById('totalHours').value);
            const periods = [];
            let currentPeriodStart = new Date(startDate);
            let periodNumber = 1;
            let classDateIndex = 0;
            let accumulatedHours = 0; // ëˆ„ì  ìˆ˜ì—…ì‹œê°„

            while (classDateIndex < classDates.length && accumulatedHours < totalHours) {
                // ë§Œ 1ê°œì›” ì¢…ë£Œì¼ ê³„ì‚°
                const periodEnd = addOneMonth(currentPeriodStart);
                
                // ì´ ê¸°ê°„ ë‚´ì˜ ìˆ˜ì—…ì¼ ì°¾ê¸°
                const periodClassDates = [];
                
                while (classDateIndex < classDates.length) {
                    const classDate = classDates[classDateIndex];
                    if (classDate <= periodEnd) {
                        periodClassDates.push(classDate);
                        classDateIndex++;
                    } else {
                        break;
                    }
                }

                if (periodClassDates.length > 0) {
                    const actualPeriodEnd = periodClassDates[periodClassDates.length - 1];
                    
                    // ì´ ê¸°ê°„ì˜ ì˜ˆìƒ ìˆ˜ì—…ì‹œê°„ ê³„ì‚°
                    let periodHours = periodClassDates.length * dailyHours;
                    
                    // ì´ ìˆ˜ì—…ì‹œê°„ì„ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ ì¡°ì •
                    if (accumulatedHours + periodHours > totalHours) {
                        periodHours = totalHours - accumulatedHours;
                    }
                    
                    // ë‹¨ìœ„ê¸°ê°„ ìˆ˜ì—…ì¼ = ë‹¨ìœ„ê¸°ê°„ ìˆ˜ì—…ì‹œê°„ / 1ì¼ ìˆ˜ì—…ì‹œê°„
                    const periodDays = Math.ceil(periodHours / dailyHours);
                    
                    accumulatedHours += periodHours;
                    
                    // ë§ˆì§€ë§‰ ë‹¨ìœ„ê¸°ê°„ì¸ì§€ í™•ì¸ (ëˆ„ì ì‹œê°„ì´ ì´ ìˆ˜ì—…ì‹œê°„ì— ë„ë‹¬í–ˆê±°ë‚˜ ëª¨ë“  ìˆ˜ì—…ì¼ì„ ì†Œì§„)
                    const isRemaining = (accumulatedHours >= totalHours || classDateIndex >= classDates.length) && 
                                       actualPeriodEnd < periodEnd;
                    
                    periods.push({
                        number: periodNumber,
                        startDate: formatDate(currentPeriodStart),
                        endDate: formatDate(actualPeriodEnd),
                        classDays: periodDays,
                        totalHours: periodHours,
                        isRemaining: isRemaining
                    });
                }

                // ë‹¤ìŒ ê¸°ê°„ ì‹œì‘ì¼ ì„¤ì •
                currentPeriodStart = new Date(periodEnd);
                currentPeriodStart.setDate(currentPeriodStart.getDate() + 1);
                periodNumber++;
            }

            displayPeriods(periods);
        }

        // ì°¨ìˆ˜ë³„ ì •ë³´ í‘œì‹œ í•¨ìˆ˜
        function displayPeriods(periods) {
            const periodSection = document.getElementById('periodSection');
            const periodList = document.getElementById('periodList');
            
            periodList.innerHTML = '';
            
            periods.forEach(period => {
                const periodItem = document.createElement('div');
                periodItem.className = 'period-item';
                
                const title = period.isRemaining ? 
                    `${period.number}ì°¨ (ì”ì—¬ ê¸°ê°„)` : 
                    `${period.number}ì°¨`;
                
                periodItem.innerHTML = `
                    <h4>${title}</h4>
                    <div class="period-info">
                        <div class="period-info-item">
                            <strong>ê¸°ê°„</strong>
                            <span>${period.startDate} ~ ${period.endDate}</span>
                        </div>
                        <div class="period-info-item">
                            <strong>ìˆ˜ì—…ì¼ìˆ˜</strong>
                            <span>${period.classDays}ì¼</span>
                        </div>
                        <div class="period-info-item">
                            <strong>êµìœ¡ì‹œê°„</strong>
                            <span>${period.totalHours}ì‹œê°„</span>
                        </div>
                    </div>
                `;
                
                periodList.appendChild(periodItem);
            });
            
            periodSection.style.display = 'block';
        }

        function generateCalendar(startDate, endDate, classDates) {
            const calendarSection = document.getElementById('calendarSection');
            calendarSection.innerHTML = '';

            const classDateStrs = classDates.map(d => formatDate(d));
            const startDateStr = formatDate(startDate);
            const endDateStr = formatDate(endDate);

            let currentMonth = new Date(startDate.getFullYear(), startDate.getMonth(), 1);
            const lastMonth = new Date(endDate.getFullYear(), endDate.getMonth(), 1);

            while (currentMonth <= lastMonth) {
                const monthDiv = document.createElement('div');
                monthDiv.className = 'calendar-month';

                const monthTitle = document.createElement('h4');
                monthTitle.textContent = `${currentMonth.getFullYear()}ë…„ ${currentMonth.getMonth() + 1}ì›”`;
                monthDiv.appendChild(monthTitle);

                const calendarGrid = document.createElement('div');
                calendarGrid.className = 'calendar-grid';

                const weekdays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
                weekdays.forEach((day, index) => {
                    const header = document.createElement('div');
                    header.className = 'calendar-header';
                    if (index === 0) header.classList.add('sun');
                    if (index === 6) header.classList.add('sat');
                    header.textContent = day;
                    calendarGrid.appendChild(header);
                });

                const firstDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1).getDay();
                
                for (let i = 0; i < firstDay; i++) {
                    const emptyDiv = document.createElement('div');
                    emptyDiv.className = 'calendar-day empty';
                    calendarGrid.appendChild(emptyDiv);
                }

                const daysInMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0).getDate();
                
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), day);
                    const dateStr = formatDate(date);
                    const dayOfWeek = date.getDay();

                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'calendar-day';

                    if (dayOfWeek === 0) dayDiv.classList.add('sun');
                    if (dayOfWeek === 6) dayDiv.classList.add('sat');
                    if (isWeekend(date)) dayDiv.classList.add('weekend');

                    if (dateStr === startDateStr) {
                        dayDiv.classList.add('start-day');
                    } else if (dateStr === endDateStr) {
                        dayDiv.classList.add('end-day');
                    } else if (classDateStrs.includes(dateStr)) {
                        dayDiv.classList.add('class-day');
                    }

                    const holidayName = getHolidayName(dateStr);
                    if (holidayName) {
                        dayDiv.classList.add('holiday');
                        if (customHolidays.some(h => h.date === dateStr)) {
                            dayDiv.classList.add('custom-holiday');
                        }
                    }

                    dayDiv.innerHTML = `
                        <div>${day}</div>
                        ${holidayName ? `<div class="holiday-name">${holidayName}</div>` : ''}
                    `;

                    calendarGrid.appendChild(dayDiv);
                }

                monthDiv.appendChild(calendarGrid);
                calendarSection.appendChild(monthDiv);

                currentMonth.setMonth(currentMonth.getMonth() + 1);
            }
        }

        function saveCourse() {
            const courseName = document.getElementById('courseName').value;
            const startDate = document.getElementById('startDate').value;
            const dailyHours = document.getElementById('dailyHours').value;
            const totalHours = document.getElementById('totalHours').value;
            const resultEndDate = document.getElementById('resultEndDate').textContent;
            const resultClassDays = document.getElementById('resultClassDays').textContent;

            if (!courseName || !startDate || resultEndDate === '-') {
                alert('ê³¼ì •ëª…ì„ ì…ë ¥í•˜ê³  ë¨¼ì € ê³„ì‚°ì„ ìˆ˜í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }

            const course = {
                name: courseName,
                startDate: startDate,
                endDate: resultEndDate,
                dailyHours: dailyHours,
                totalHours: totalHours,
                classDays: resultClassDays.replace('ì¼', ''),
                customHolidays: [...customHolidays]
            };

            savedCourses.push(course);
            saveCourseToStorage();
            displaySavedCourses();
            alert('ê³¼ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function clearForm() {
            document.getElementById('courseName').value = '';
            document.getElementById('startDate').value = '';
            document.getElementById('dailyHours').value = '8';
            document.getElementById('totalHours').value = '100';
            document.getElementById('newCustomHolidayDate').value = '';
            document.getElementById('newCustomHolidayName').value = '';
            
            customHolidays = [];
            saveCustomHolidays();

            document.getElementById('resultSection').style.display = 'none';
            document.getElementById('periodSection').style.display = 'none';
            document.getElementById('legend').style.display = 'none';
            document.getElementById('calendarSection').innerHTML = '';
        }

        window.onload = function() {
            displaySavedCourses();
            displayCustomHolidays();
            const today = new Date();
            document.getElementById('startDate').value = formatDate(today);
        };
    </script>
</body>
</html>
